---
title: "Análisis Base de Datos Simplificada"
author: "Tomás Sánchez Grigioni"
date: "13/9/2020"
output: html_document
---

```{r, include = FALSE}
# Bibliotecas
library(knitr)
library(readxl)
library(dplyr)
```

```{r setup, include = FALSE, cache = FALSE}
opts_chunk$set(echo = FALSE)
opts_knit$set(root.dir = "../")
```

```{r, include = FALSE}
# Funciones utiles
source("./R/Utils.R")
```

## Análisis de Datos

Las variables que vamos a utilizar son

|Nombre Variable (viejo)|Nombre Variable (nuevo)|Significado|Tipo Variable|
|:------:|:------------:|:--------------------|:-----------:|
|ROW_ID|id|Es el identificador de fila|-|
|age|edad|Edad del paciente|Discreta|
|EdadR|?|?|Discreta|
|DIAGNOSTICO|diagnostico|Resultado del diagnóstico. 1 = Enfermo 0 = No enfermo|Categórica|
|M_POINT|?|?|Categórica|
|Sex|sexo|Sexo del paciente|-|
|d1|d1|Mean of logarithmic F0 on a semitone frequency scale|Continua|
|d2|d2|Mean of the ratio of the energy of the spectral harmonic peak at the first formant’s center frequency to the energy of the spectral peak at F0 in voiced regions|Continua|
|d3|d3| Coefficient of variation of the ratio of the energy of the spectral harmonic peak at the first formant’s center frequency to the energy of the spectral peak at F0 in voiced regions|Continua|
|d4|d4|Mean of linear regression slope of the logarithmic power spectrum within 0–500 Hz band entropy.|Continua|
|d5|d5|Mean Jitter of the deviations in individual consecutive F0 period lengths.|Continua|

Primero cargamos los datos, luego observamos como los trata R.

```{r}
datos_crudos <- read_excel("./data/bd_acotada.xlsx")
str(datos_crudos)
```

Los problemas que encontramos son:

* **Diagnostico** no es un factor.
* **M_POINT** no es un factor.
* **SEX** no es un factor.
* Además le cambiamos lo nombres a las variables para que sea más manejable.

```{r}
datos_it0 <- datos_crudos %>%
  rename(id = ROW_ID, edad = age, diagnostico = DIAGNOSTICO, sexo = SEX, m_point = M_POINT) %>% 
  mutate(diagnostico = as.factor(diagnostico), m_point = as.factor(m_point), sexo = as.factor(sexo))

str(datos_it0)
```

Ahora las variables se tratan correctamente. Calculamos las medidas resumen para las variables cuantitativas y creamos tablas de frecuencia para variables cualitativas

```{r}
# Para variables cualtiativas
df_aux <- datos_it0 %>% 
  select(where(is.numeric)) %>% 
  mutate(id = NULL)

lista_aux <- list(data = df_aux, nombre_var = names(df_aux))

kable(pmap_dfr(lista_aux, medidas_resumen))

# Para variables cuantitativas
kable(table(datos_it0$diagnostico))
kable(table(datos_it0$m_point))
kable(table(datos_it0$sexo))

rm(df_aux,lista_aux)
  
```

